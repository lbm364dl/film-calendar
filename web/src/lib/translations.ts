export type LangKey = 'es' | 'en';

type TranslationValue = string | ((...args: any[]) => string);

export const TRANSLATIONS: Record<LangKey, Record<string, TranslationValue>> = {
  es: {
    viewersLabel: (n: string) => `Vista por ${n} personas`,
    siteTitle: 'üé¨ Madrid Film Calendar',
    subtitle: 'Cine Estudio ‚Ä¢ Cine Paz ‚Ä¢ Cineteca ‚Ä¢ Dor√© ‚Ä¢ Embajadores ‚Ä¢ Golem ‚Ä¢ Renoir ‚Ä¢ Sala Berlanga ‚Ä¢ Sala Equis ‚Ä¢ Verdi ‚Ä¢ M√°s pr√≥ximamente...',
    searchPlaceholder: 'Buscar por t√≠tulo o director',
    selectDate: 'Elegir d√≠a',
    allTheaters: 'Todos los cines',
    yearFrom: 'A√±o desde',
    yearTo: 'A√±o hasta',
    watchlistFull: 'En watchlist de Letterboxd',
    watchlistShort: 'En watchlist',
    watchlistActive: 'Watchlist activa',
    watchlistBtnTitle: 'Filtrar por watchlist de Letterboxd',
    watchlistToggleTitle: 'Activar/desactivar filtro de watchlist',
    watchlistIconTitle: 'Watchlist',
    watchedFull: 'No vistas en Letterboxd',
    watchedShort: 'No vistas',
    watchedActive: 'Vistas activa',
    watchedBtnTitle: 'Filtrar por pel√≠culas vistas en Letterboxd',
    watchedToggleTitle: 'Activar/desactivar filtro de no vistas',
    watchedIconTitle: 'No vistas',
    clearFilters: 'Limpiar filtros',
    clearFiltersTitle: 'Limpiar todos los filtros',
    csvTooltipTitle: '<strong>Filtrar con tus datos de Letterboxd</strong>',
    csvStep1: 'Ve a <a href="https://letterboxd.com/settings/data/" target="_blank">letterboxd.com/settings/data</a>',
    csvStep2: 'Haz clic en <em>Export your data</em>',
    csvStep3: 'Del ZIP descargado, sube <em>watchlist.csv</em> y/o <em>watched.csv</em> aqu√≠',
    csvStep4: 'Activa/desactiva los filtros',
    csvPersistence: 'Los archivos se guardan en el navegador y sobreviven cuando vuelvas a abrir la p√°gina.',
    filmCount: (n: number) => `${n} pel√≠cula${n !== 1 ? 's' : ''}`,
    calendarHint: 'Haz clic en cualquier sesi√≥n para entradas y opciones de calendario',
    loading: 'Cargando pel√≠culas...',
    errorLoading: 'Error al cargar pel√≠culas. Int√©ntalo de nuevo m√°s tarde.',
    noResults: 'No se encontraron pel√≠culas con los criterios seleccionados.',
    buyTickets: 'Comprar entradas',
    viewFilmPage: 'Ver ficha',
    addToCalendar: 'A√±adir al calendario',
    nLocations: (n: number) => `${n} salas`,
    nTheaters: (n: number) => `${n} cines`,
    watchlistCount: (n: number) => `${n} pel√≠culas en la watchlist`,
    watchedCount: (n: number) => `${n} pel√≠culas vistas`,
    ratingTooltip: (rating: string) => `${rating} de 5 en Letterboxd`,
    removeWatchlist: 'Quitar watchlist',
    removeWatched: 'Quitar vistas',
    footerCreated: 'Creado con ayuda de IA ‚Ä¢ Patrocinado por mi amor por el cine',
    footerThanks: 'Gracias a los cines de Madrid, a <a href="https://letterboxd.com" target="_blank" rel="noopener noreferrer" class="attribution-link">Letterboxd</a> y a <a href="https://www.themoviedb.org" target="_blank" rel="noopener noreferrer" class="attribution-link">TMDB</a>.',
    footerMistakes: 'Si encuentras alg√∫n error, <a href="mailto:ctl.covaci@gmail.com">escr√≠beme</a>, <a href="https://github.com/lbm364dl/film-calendar/issues">abre una issue en GitHub</a> o <a href="https://github.com/lbm364dl/film-calendar/blob/main/docs/screenings.json" target="_blank">corr√≠gelo t√∫ mismo</a> con una Pull Request.',
    viewOnGithub: 'Ver en GitHub',
    dubbedTooltip: 'Doblada al castellano',
    loadMore: (n: number) => `Mostrar m√°s (${n} restantes)`,
  },
  en: {
    viewersLabel: (n: string) => `${n} viewers`,
    siteTitle: 'üé¨ Madrid Film Calendar',
    subtitle: 'Cine Estudio ‚Ä¢ Cine Paz ‚Ä¢ Cineteca ‚Ä¢ Dor√© ‚Ä¢ Embajadores ‚Ä¢ Golem ‚Ä¢ Renoir ‚Ä¢ Sala Berlanga ‚Ä¢ Sala Equis ‚Ä¢ Verdi ‚Ä¢ More coming...',
    searchPlaceholder: 'Search by title or director',
    selectDate: 'Select date',
    allTheaters: 'All Theaters',
    yearFrom: 'Year from',
    yearTo: 'Year to',
    watchlistFull: 'On Letterboxd watchlist',
    watchlistShort: 'On watchlist',
    watchlistActive: 'Watchlist active',
    watchlistBtnTitle: 'Filter by Letterboxd watchlist',
    watchlistToggleTitle: 'Toggle watchlist filter',
    watchlistIconTitle: 'Watchlist',
    watchedFull: 'Not watched on Letterboxd',
    watchedShort: 'Not watched',
    watchedActive: 'Watched active',
    watchedBtnTitle: 'Filter by Letterboxd watched',
    watchedToggleTitle: 'Toggle not watched filter',
    watchedIconTitle: 'Not watched',
    clearFilters: 'Clear all filters',
    clearFiltersTitle: 'Clear all filters',
    csvTooltipTitle: '<strong>Filter with your Letterboxd data</strong>',
    csvStep1: 'Go to <a href="https://letterboxd.com/settings/data/" target="_blank">letterboxd.com/settings/data</a>',
    csvStep2: 'Click <em>Export your data</em>',
    csvStep3: 'From the downloaded ZIP, upload <em>watchlist.csv</em> and/or <em>watched.csv</em> here',
    csvStep4: 'Toggle the filters on/off with the switches',
    csvPersistence: 'Files are saved in your browser and persist across page refreshes.',
    filmCount: (n: number) => `${n} film${n !== 1 ? 's' : ''}`,
    calendarHint: 'Click any session for tickets & calendar options',
    loading: 'Loading films...',
    errorLoading: 'Error loading films. Please try again later.',
    noResults: 'No films found matching your criteria.',
    buyTickets: 'Buy Tickets',
    viewFilmPage: 'View Film Page',
    addToCalendar: 'Add to Calendar',
    nLocations: (n: number) => `${n} locations`,
    nTheaters: (n: number) => `${n} theaters`,
    watchlistCount: (n: number) => `${n} films on watchlist`,
    watchedCount: (n: number) => `${n} watched films`,
    ratingTooltip: (rating: string) => `${rating} out of 5 on Letterboxd`,
    removeWatchlist: 'Remove watchlist',
    removeWatched: 'Remove watched',
    footerCreated: 'Created with the help of AI ‚Ä¢ Sponsored by my love for films',
    footerThanks: 'Thanks to Madrid theaters, <a href="https://letterboxd.com" target="_blank" rel="noopener noreferrer" class="attribution-link">Letterboxd</a>, and <a href="https://www.themoviedb.org" target="_blank" rel="noopener noreferrer" class="attribution-link">TMDB</a>.',
    footerMistakes: 'If you find any mistakes, <a href="mailto:ctl.covaci@gmail.com">write to me</a>, <a href="https://github.com/lbm364dl/film-calendar/issues">open a GitHub issue</a> or <a href="https://github.com/lbm364dl/film-calendar/blob/main/docs/screenings.json" target="_blank">fix it yourself</a> via Pull Request.',
    viewOnGithub: 'View on GitHub',
    dubbedTooltip: 'Dubbed in Spanish',
    loadMore: (n: number) => `Load more (${n} remaining)`,
  }
};

export const GENRE_TRANSLATIONS_ES: Record<string, string> = {
  'action': 'Acci√≥n',
  'adventure': 'Aventura',
  'animation': 'Animaci√≥n',
  'biography': 'Biograf√≠a',
  'comedy': 'Comedia',
  'crime': 'Crimen',
  'documentary': 'Documental',
  'drama': 'Drama',
  'family': 'Familiar',
  'fantasy': 'Fantas√≠a',
  'film-noir': 'Cine negro',
  'history': 'Historia',
  'horror': 'Terror',
  'music': 'M√∫sica',
  'musical': 'Musical',
  'mystery': 'Misterio',
  'romance': 'Romance',
  'science fiction': 'Ciencia ficci√≥n',
  'short': 'Cortometraje',
  'sport': 'Deporte',
  'thriller': 'Thriller',
  'tv movie': 'Pel√≠cula para TV',
  'war': 'B√©lico',
  'western': 'W√©stern',
};

export function t(lang: LangKey, key: string, ...args: any[]): string {
  const val = TRANSLATIONS[lang]?.[key] ?? TRANSLATIONS.en[key] ?? key;
  return typeof val === 'function' ? val(...args) : val;
}

export function translateGenre(genre: string, lang: LangKey): string {
  if (!genre || lang !== 'es') return genre;
  return GENRE_TRANSLATIONS_ES[genre.trim().toLowerCase()] || genre;
}
